# ðŸ¦  Malware Compromise Analysis Report â€” Umbrella Corporation

* **Date of Analysis:** 06 September 2025
* **Analyst:** Belhamici Abderrahmane
* **Source:** [Blue Team Labs Online â€” *Network Analysis - Malware Compromise*](https://blueteamlabs.online/home/challenge/network-analysis-malware-compromise-e882f32908)
* **Dataset:** Network packet capture (PCAP) from compromised accounting workstation
* **Incident Date:** November 27, 2018

---

## 1. Executive Summary

This report details the analysis of a sophisticated malware compromise at Umbrella Corporation targeting an accounting department workstation. The incident involved a multi-stage infection chain beginning with a macro-enabled document delivered via email, leading to Ursnif malware deployment and subsequent Dridex banking trojan infection. The attack demonstrates advanced persistence mechanisms, command and control infrastructure, and financial data targeting typical of modern banking malware campaigns.

The compromise resulted in a 42-minute active infection period with persistent communication to multiple Russian-hosted command and control servers, indicating potential financial data exfiltration and banking credential theft.

---

## 2. Case Overview

* **Incident Date:** November 27, 2018
* **Attack Timeline:** 17:30:12 â€” 18:12:16 UTC (42 minutes 03 seconds)
* **Compromised System:** Sara's accounting workstation (10.11.27.101)
* **Initial Vector:** Macro-enabled document received via email
* **Primary Malware:** Ursnif banking trojan with Dridex follow-up payload
* **Attack Origin:** Customer impersonation via compromised business email
* **DNS Server:** 10.11.27.1 (internal DNS infrastructure)

---

## 3. Key Findings

### 3.1 Network Infrastructure Summary

* **Infected Host IP:** `10.11.27.101` (Sara's accounting workstation)
* **DNS Server:** `10.11.27.1` (internal infrastructure)
* **Attack Duration:** 42 minutes 03 seconds
* **C2 Domains:** 5 malicious domains across Russian and Dutch hosting
* **Payloads Downloaded:** 6 malicious files with various disguised extensions
* **Primary Malware Family:** Ursnif with Dridex banking trojan deployment

### 3.2 Malware Execution Timeline

**Phase 1 - Initial Infection (17:30:12 - 17:30:16)**
* Macro document triggers initial payload download
* Connection to `klychenogg.com` (95.181.198.232)
* Download of `spet10.spr` (Ursnif loader) disguised as sawwhole.exe

**Phase 2 - Reconnaissance and C2 Establishment (17:30:34 - 17:38:39)**
* Multiple connections to `cochrimato.com` (176.32.33.108)
* DNS resolution via OpenDNS (208.67.222.222)
* Communication with `mautergase.com` (83.166.247.211)

**Phase 3 - Payload Deployment (17:38:39 - 17:38:57)**
* Download of Dridex payload via `oiioiashdqbwe.rar`
* Additional malicious files retrieved from multiple C2 servers

**Phase 4 - Persistent Communication (17:38:57 - 18:12:16)**
* Extended communication with Netherlands-based C2 (185.244.150.230)
* Banking trojan data exfiltration activities

---

## 4. Technical Analysis

### 4.1 Command and Control Infrastructure

**Primary C2 Server #1: klychenogg.com**
* **IP Address:** 95.181.198.232 (Russia)
* **Threat Intelligence:** 9/95 security vendors flagged as malicious
* **Activity Periods:**
  - Phase A: 17:30:12 - 17:30:16 (initial payload download)
  - Phase B: 17:38:39 - 17:38:45 (secondary payload retrieval)
* **Key Downloads:**
  - `GET /QIC/tewokl.php?l=spet10.spr` (Ursnif loader)
  - `GET /oiioiashdqbwe.rar` (Dridex payload archive)

**Primary C2 Server #2: cochrimato.com**
* **IP Address:** 176.32.33.108 (Russia)
* **Threat Intelligence:** 5/95 security vendors flagged as malicious
* **Activity Period:** 17:30:34 - 17:30:43, 17:38:39 - 17:38:40
* **Communication Pattern:** Multiple GET requests to `/images/` directory structure
* **Payload Downloads:**
  - `ojw.avi` (disguised malware payload)
  - `6.avi` (disguised malware payload)
  - `timxEQW.avi` (disguised malware payload)

**Secondary C2 Server #3: mautergase.com**
* **IP Address:** 83.166.247.211 (Russia)
* **Threat Intelligence:** 1/95 security vendors flagged as malicious
* **Activity Periods:**
  - Primary: 17:31:49 - 17:38:39
  - Extended: 17:38:50 - 18:12:16
* **Purpose:** Persistent command and control communication

**Banking Data Exfiltration Server: 185.244.150.230**
* **IP Address:** 185.244.150.230 (Netherlands)
* **Activity Period:** 17:38:57 - 18:03:24 (24 minutes 27 seconds)
* **Purpose:** Dridex banking trojan post-infection traffic
* **Data Type:** Financial credentials and banking session information

### 4.2 DNS Resolution Analysis

**External DNS Usage:**
* **OpenDNS Resolver:** resolver1.opendns.com (208.67.222.222)
* **Activity Period:** 17:31:47 - 17:31:50
* **Purpose:** Bypass internal DNS filtering and resolution caching
* **Significance:** Indicates malware attempting to evade DNS-based security controls

### 4.3 Malware Payload Analysis

**Primary Payload: spet10.spr (Ursnif Loader)**
* **File Type:** PE32 executable (disguised as .spr file)
* **SHA256:** `AAA41C27D5B4A160ED2A00BA820DD6ADA86ED80E76D476A8379543478E608F84`
* **Threat Classification:** 59/72 security vendors flagged as malicious (TROJAN)
* **Alternative Name:** sawwhole.exe
* **Function:** Initial stage loader for Ursnif banking trojan

**Secondary Payloads (Disguised as .avi files):**
1. **ojw.avi**
   * **SHA256:** `3259DBD2061B71E58F400F4041241A54EA1790A78F284B506469A03F5BD32497`
   * **File Type:** ASCII text with very long lines (65512 bytes)
   * **Purpose:** Obfuscated configuration or secondary payload

2. **6.avi**
   * **SHA256:** `05BDCAD6A7E0F152ADB2CC489CDEC1C18718F767DB0E3BD48B59B6411609CA48`
   * **File Type:** ASCII text with very long lines (65512 bytes)
   * **Purpose:** Additional malware component or configuration

3. **timxEQW.avi**
   * **SHA256:** `37E3E010F4362C94C980D9F9F115B1159A8CA29977F2653CBDC5AF3BF1BDFB9B`
   * **File Type:** ASCII text with long lines (2352 bytes)
   * **Purpose:** Compressed or encoded malware payload

**Archive Payload: oiioiashdqbwe.rar**
* **SHA256:** `AB51760A4B74FCC54E76278640A1EC5C231FAAEA4F9EDDAE72D37EF6B635B499`
* **File Type:** Compressed archive (binary data)
* **Contents:** Dridex banking trojan payload
* **URL:** `http://klychenogg.com/oiioiashdqbwe.rar`

**Additional Files:**
* **favicon.ico**
  * **SHA256:** `E78286D0F5DFA2C85615D11845D1B29B0BFEC227BC077E74CB1FF98CE8DF4C5A`
  * **File Type:** MS Windows icon resource (16x16 and 32x32 pixels)
  * **Purpose:** Likely used for process camouflaging or legitimate appearance

---

## 5. Attack Vector Analysis

### 5.1 Initial Compromise Method

**Delivery Method:** Business email compromise via customer impersonation
**Target:** Sara (Accounting Department) - high-volume email recipient
**Payload:** Invoice document with malicious macro
**Social Engineering:** Customer invoice document (routine business communication)
**Execution:** User-initiated macro execution leading to program crash (deliberate misdirection)

### 5.2 Infection Chain Analysis

1. **Email Delivery:** Macro-enabled document received from compromised customer account
2. **User Interaction:** Sara opens document and enables macros
3. **Initial Download:** Macro contacts `klychenogg.com` to retrieve Ursnif loader
4. **Persistence Establishment:** Ursnif installs and begins system reconnaissance
5. **C2 Communication:** Multiple connections to Russian-hosted infrastructure
6. **Secondary Payload:** Dridex banking trojan downloaded via .rar archive
7. **Data Exfiltration:** Banking credentials and financial data transmitted to Netherlands server

### 5.3 Evasion Techniques

* **File Extension Masquerading:** Executable files disguised as .spr and .avi extensions
* **DNS Filtering Bypass:** Use of external DNS resolver (OpenDNS)
* **Multi-Stage Payload:** Graduated download of components to avoid detection
* **Legitimate File Mimicking:** favicon.ico and media file extensions for camouflage
* **Geographic Distribution:** C2 infrastructure spread across multiple countries

---

## 6. Malware Family Analysis

### 6.1 Ursnif Banking Trojan

**Primary Characteristics:**
* **Target:** Banking credentials and financial information
* **Persistence:** Registry modifications and startup folder installation
* **Data Theft:** Web form grabbing, screenshot capture, keylogging
* **Communication:** HTTP POST requests to multiple C2 servers
* **Evasion:** Process injection, anti-analysis techniques

**Observed Behaviors:**
* Multi-stage payload deployment
* Communication with Russian-hosted infrastructure
* Secondary malware deployment capabilities
* Financial data exfiltration via encrypted channels

### 6.2 Dridex Banking Trojan

**Secondary Infection Characteristics:**
* **Delivery:** Downloaded as follow-up payload from Ursnif infection
* **Target:** Advanced banking session hijacking and credential theft
* **C2 Communication:** 185.244.150.230 (Netherlands-based infrastructure)
* **Data Exfiltration:** 24+ minutes of continuous communication
* **Advanced Capabilities:** Man-in-the-browser attacks, transaction manipulation

---

## 7. Network Communication Analysis

### 7.1 HTTP Traffic Pattern Analysis

**Domain: klychenogg.com (95.181.198.232)**
```
GET /QIC/tewokl.php?l=spet10.spr HTTP/1.1
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1)
Connection: Close
```

**Domain: cochrimato.com (176.32.33.108)**
```
GET /images/[OBFUSCATED_PATH]/ojw.avi HTTP/1.1
GET /images/[OBFUSCATED_PATH]/6.avi HTTP/1.1
GET /images/[OBFUSCATED_PATH]/timxEQW.avi HTTP/1.1
```

**Path Obfuscation Analysis:**
* URLs contain base64-like encoding and URL encoding (%2B, %2F)
* Directory structure designed to evade URL filtering
* Multiple levels of subdirectories for evasion

### 7.2 Traffic Volume Analysis

| Time Period | Primary Activity | Duration |
|-------------|------------------|----------|
| 17:30:12-17:30:16 | Initial payload download | 4 seconds |
| 17:30:34-17:38:39 | C2 establishment and reconnaissance | 8 minutes 5 seconds |
| 17:38:39-17:38:57 | Secondary payload deployment | 18 seconds |
| 17:38:57-18:12:16 | Banking data exfiltration | 33 minutes 19 seconds |

---

## 8. Indicators of Compromise (IOCs)

### 8.1 Network Indicators

| Indicator | Type | Description | Threat Level |
|-----------|------|-------------|--------------|
| `10.11.27.101` | IP Address | Infected accounting workstation | Internal |
| `95.181.198.232` | IP Address | klychenogg.com C2 server (Russia) | Critical |
| `176.32.33.108` | IP Address | cochrimato.com C2 server (Russia) | Critical |
| `83.166.247.211` | IP Address | mautergase.com C2 server (Russia) | High |
| `185.244.150.230` | IP Address | Dridex C2 server (Netherlands) | Critical |
| `208.67.222.222` | IP Address | OpenDNS resolver (DNS bypass) | Medium |
| `klychenogg.com` | Domain | Primary C2 domain | Critical |
| `cochrimato.com` | Domain | Secondary C2 domain | Critical |
| `mautergase.com` | Domain | Persistent C2 domain | High |

### 8.2 File Indicators

| Indicator | Type | SHA256 Hash | Threat Level |
|-----------|------|-------------|--------------|
| `spet10.spr` | Ursnif Loader | `AAA41C27D5B4A160ED2A00BA820DD6ADA86ED80E76D476A8379543478E608F84` | Critical |
| `sawwhole.exe` | Alternate Name | `AAA41C27D5B4A160ED2A00BA820DD6ADA86ED80E76D476A8379543478E608F84` | Critical |
| `oiioiashdqbwe.rar` | Dridex Payload | `AB51760A4B74FCC54E76278640A1EC5C231FAAEA4F9EDDAE72D37EF6B635B499` | Critical |
| `ojw.avi` | Disguised Payload | `3259DBD2061B71E58F400F4041241A54EA1790A78F284B506469A03F5BD32497` | High |
| `6.avi` | Disguised Payload | `05BDCAD6A7E0F152ADB2CC489CDEC1C18718F767DB0E3BD48B59B6411609CA48` | High |
| `timxEQW.avi` | Disguised Payload | `37E3E010F4362C94C980D9F9F115B1159A8CA29977F2653CBDC5AF3BF1BDFB9B` | High |
| `favicon.ico` | Camouflage File | `E78286D0F5DFA2C85615D11845D1B29B0BFEC227BC077E74CB1FF98CE8DF4C5A` | Medium |

### 8.3 URL Indicators

| URL Pattern | Purpose | Risk Level |
|-------------|---------|------------|
| `/QIC/tewokl.php?l=spet10.spr` | Initial payload download | Critical |
| `/images/[OBFUSCATED]/*.avi` | Secondary payload downloads | High |
| `/oiioiashdqbwe.rar` | Dridex payload archive | Critical |

---

âœ… **Conclusion:**
The analysis of the Umbrella Corporation malware compromise reveals a sophisticated multi-stage banking trojan infection involving Ursnif and Dridex malware families. The 42-minute attack timeline demonstrates advanced persistence techniques, multi-country C2 infrastructure, and specific targeting of financial data through business email compromise. The incident resulted in significant banking credential exposure and potential financial data theft through extended communication with Netherlands-based exfiltration servers. This compromise highlights critical gaps in email security, DNS controls, and behavioral monitoring that require immediate remediation to prevent similar financial-focused attacks targeting accounting department personnel and business banking operations.